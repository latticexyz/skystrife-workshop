import { CollapseCode } from "../../components/CollapseCode";

# 1. New namespace

**In this section, we will accomplish the following:**

1. Create our own namespace on an existing Sky Strife world with a `InLeague` table.
2. Use a system to allow players to join the leauge
3. Allow using the system on the client

## 1.1. Creating the table

In the `contracts` folder there is a `mud.config.ts` file.

<CollapseCode>

```tsx filename="mud.config.ts" {5-8} copy showLineNumbers
import { mudConfig } from "@latticexyz/world/register";

export default mudConfig({
  tables: {
    InLeague: {
      keySchema: { account: "address" },
      valueSchema: { inLeague: "bool" },
    },
  },
});
```

</CollapseCode>

## 1.2. Create the system

Let's customise ` JoinSystem.sol` in `src/systems`. We add `joinLeague` method, which will assign the `InLeague` tables to the given address.

<CollapseCode>

```solidity filename="JoinSystem.sol" {5, 8-10} copy showLineNumbers
// SPDX-License-Identifier: MIT
pragma solidity >=0.8.0;

import { System } from "@latticexyz/world/src/System.sol";
import { InLeague } from "../codegen/index.sol";

contract JoinSystem is System {
  function joinLeague(address account) public {
    InLeague.set(account, true);
  }
}
```

</CollapseCode>

## 1.3. Use the system on the client

Let's display our league.

<CollapseCode>

```tsx filename="App.tsx" {} copy showLineNumbers
import { useMUD } from "./MUDContext";
import { Hex } from "viem";

function Player({ address }: { address: Hex }) {
  const {
    network: { tables, useStore },
  } = useMUD();

  const name = useStore((state) =>
    state.getValue(tables.Name, { key: address })
  );

  return <span>{name ? name.value : address}</span>;
}

function League() {
  const {
    network: { tables, useStore },
  } = useMUD();

  const accounts = useStore((state) =>
    state.getRecords(tables.League_InLeague)
  );

  return (
    <div>
      {Object.values(accounts).map((record) =>
        record.value.inLeague ? (
          <div key={record.key.account}>
            {encodeEntity(
              { address: "address" },
              { address: record.key.account }
            )}
          </div>
        ) : null
      )}
    </div>
  );
}

export function App() {
  const {
    network: { tables, useStore },
  } = useMUD();

  const rankings = useStore((state) => {
    return Object.values(state.getRecords(tables.MatchRanking)).map(
      (record) => ({
        matchEntity: record.key.key,
        players: record.value.value.map((entity) => {
          const owner = state.getValue(tables.OwnedBy, {
            matchEntity: record.key.key,
            entity,
          });

          if (owner) return owner.value;

          return entity;
        }),
      })
    );
  });

  return (
    <div>
      {rankings.map(({ matchEntity, players }) => (
        <div key={matchEntity}>
          Match #{matchEntity}:
          {players.map((address, i) => (
            <div key={`${matchEntity}_${address}`}>
              {i + 1}: <Player address={address} />
            </div>
          ))}
        </div>
      ))}
      <League />
    </div>
  );
}
```

</CollapseCode>

Oh no, the league is empty. Let's interact with the system to use it.

<CollapseCode>

```tsx filename="App.tsx" {16-34, 71} copy showLineNumbers
import { useState } from "react";
import { useMUD } from "./MUDContext";
import { Hex } from "viem";

function Player({ address }: { address: Hex }) {
  const {
    network: { tables, useStore },
  } = useMUD();

  const name = useStore((state) =>
    state.getValue(tables.Name, { key: address })
  );

  return <span>{name ? name.value : address}</span>;
}

function League() {
  const {
    network: { tables, useStore, worldContract },
  } = useMUD();

  const [address, setAddress] = useState("");

  const accounts = useStore((state) =>
    state.getRecords(tables.League_InLeague)
  );

  return (
    <div>
      <form onSubmit={(e) => e.preventDefault()}>
        <input
          value={address}
          onChange={(event) => setAddress(event.target.value)}
          type="text"
          placeholder="0x..."
        />
        <button
          onClick={() =>
            worldContract.write.League_JoinSystem_addLeague([address as Hex])
          }
        >
          Add to league
        </button>
      </form>

      {Object.values(accounts).map((record) =>
        record.value.inLeague ? (
          <div key={record.key.account}>
            <Player address={record.key.account} />
          </div>
        ) : null
      )}
    </div>
  );
}

export function App() {
  const {
    network: { tables, useStore },
  } = useMUD();

  const rankings = useStore((state) => {
    return Object.values(state.getRecords(tables.MatchRanking)).map(
      (record) => ({
        matchEntity: record.key.key,
        players: record.value.value.map((entity) => {
          const owner = state.getValue(tables.OwnedBy, {
            matchEntity: record.key.key,
            entity,
          });

          if (owner) return owner.value;

          return entity;
        }),
      })
    );
  });

  return (
    <div>
      {rankings.map(({ matchEntity, players }) => (
        <div key={matchEntity}>
          Match #{matchEntity}:
          {players.map((address, i) => (
            <div key={`${matchEntity}_${address}`}>
              {i + 1}: <Player address={address} />
            </div>
          ))}
        </div>
      ))}
      <League />
    </div>
  );
}
```

</CollapseCode>
